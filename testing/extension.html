<style type="text/css">
  body, html {
    height: 100%;
    margin: 0;
    background: white;
    font-family: helvetica;
  }
  ul{
    list-style-type: none;
    margin: 0;
    padding: 10px;
    overflow: hidden;
  }
  li {
    float: left;
    display: block;
    text-align: center;
    padding: 6px;
    padding-left: 10px;
    margin-right: 7px;
    margin-bottom:3px;
    border-radius: 3px;
    font-size: 10px;

  }
  p{
    padding-left: 10px;
    margin: 0px;
  }
  .selectBlock{
    display: inline-block;
    margin: 3px;
    border-radius: 10px;
    padding: 3px;
    transition: background-color 0.5s ease;
  }
  .selectBlock:hover{
    cursor: pointer;
    background-color: #adcdff !important;
  }
  .selected{
    background-color: #82b1fa;
    display: inline-block;
    margin: 3px;
    border-radius: 10px;
    padding: 3px;
    transition: background-color 0.5s ease;
    color: white;
  }
  .gen{
    background-color: dodgerblue;
    border: none;
    padding: 7px;
    border-radius: 15px;
    color: white;
    margin: 3px;
    outline: none;
    transition: background-color 0.5s ease;
  }
  .gen:hover{
    background-color: #d9d9d9;
    color: black;
  }

  .collapsible {
    background-color: #555;
    color: white;
    cursor: pointer;
    padding: 18px;
    width: 100%;
    border: none;
    text-align: left;
    outline: none;
    font-size: 15px;
    transition: background-color 0.5s ease;
  }

  .active,.collapsible:hover {
    background-color: #555;
  }

  .collapsible:after {
    content: '\002B';
    color: white;
    font-weight: normal;
    float: left;
    margin-right: 10px;
  }

  .active:after {
    content: "\2212";
  }

  .content {
    padding: 0 18px;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.2s ease-out;
    background-color: #f1f1f1;
  }
  .optionblock{
    padding: 10px;
    padding-bottom: 25px;
    border-radius: 10px;
    cursor: pointer;
  }
  
  .themeName{
    font-size: 20px;
    display: inline-block;
    text-indent: 0px;
    padding-left: 0px;
  }
</style>

<div class="sidebar">
    <button class="collapsible" id="colordropdown">Select Theme</button>
    <div class="content">
        <div class="selectBlock" onclick="settheme(0)" id="1000">
            <p>Sea Blue</p>
            <ul id="0"></ul>
        </div>

        <div class="selectBlock" onclick="settheme(1)" id="1001">
            <p>Dark</p>
            <ul id="1"></ul>
        </div>

        <div class="selectBlock" onclick="settheme(2)" id="1002">
            <p>Mint</p>
            <ul id="2"></ul>
        </div>

        <div class="selectBlock" onclick="settheme(3)" id="1003">
            <p>Mint Chip</p>
            <ul id="3"></ul>
        </div>

        <div class="selectBlock" onclick="settheme(4)" id="1004">
            <p>Rainbow</p>
            <ul id="4"></ul>
        </div>
        <div class="selectBlock" onclick="settheme(5)" id="1005">
            <p>Forest Green</p>
            <ul id="5"></ul>
        </div>
        <div class="selectBlock" onclick="settheme(6)" id="1006">
            <p>Appalachian Fall</p>
            <ul id="6"></ul>
        </div>
        <div class="selectBlock" onclick="settheme(7)" id="1007">
            <p>Pastel Sunset</p>
            <ul id="7"></ul>
        </div>
        <div class="selectBlock" onclick="settheme(8)" id="1008">
            <p>Pacific Fog</p>
            <ul id="8"></ul>
        </div>
        <div class="selectBlock" onclick="settheme(9)" id="1009">
            <p>Land Before Time</p>
            <ul id="9"></ul>
        </div>
        <div class="selectBlock" onclick="settheme(10)" id="1010">
            <p>Desert Stone</p>
            <ul id="10"></ul>
        </div>
        <div class="selectBlock" onclick="settheme(11)" id="1011">
            <p>Purple Night</p>
            <ul id="11"></ul>
        </div>
        <div class="selectBlock" onclick="settheme(12)" id="1012">
            <p>Desert Noon</p>
            <ul id="12"></ul>
        </div>
        <div class="selectBlock" onclick="settheme(13)" id="1013">
            <p>Desert Sunset</p>
            <ul id="13"></ul>
        </div>
        <div class="selectBlock" onclick="settheme(14)" id="1014">
            <p>Misty Morning</p>
            <ul id="14"></ul>
        </div>
        <div class="selectBlock" onclick="settheme(15)" id="1015">
            <p>Summer Day</p>
            <ul id="15"></ul>
        </div>
    </div>

    <button class="collapsible" id="colordropdown">Options</button>

    <div class="content">
        <br>
        <div class="optionblock">Gray Overlay (0 to 1): <input type="number" step="0.01" id="settings_overlay" onchange="setoverlay()" min="0" max="1"></div>
        
        <div class="optionblock" style="background-color: #bddcfc" id = "origbox" onclick="checkorig();">
          <p class="themeName">Original:</p><input type="radio" id="origradio" name="radiobutton" value="original" checked="checked" onclick="setStyle();">
          <br><br>
          <div id="origsettings">
            Rows (0 to 15): <input type="number" id="settings_rows" onchange="changerows()" min="1" max="15">
          </div>

        </div>

        

        <div class="optionblock" id = "hexbox" onclick="checkhex();"> 
          <p class="themeName">Hexagons:</p><input type="radio" id="hexradio" name="radiobutton" value="hexagons" onchange="setStyle()"> <br><br>
          <div id = "hexagonsettings">
            Hexagon Size (10 to 200): <input type="number" step="1" id="settings_hexsize" onchange="sethexsize()" min="10" max="200"><br><br>
            Color Noise (0 to 30): <input type="number" step="1" id="settings_noise" onchange="setnoise()" min="0" max="30">
          </div>
        </div>

        

        <div class="optionblock" id = "wavebox" onclick="checkwave();">
          <p class="themeName">Waves: </p><input type="radio" id="waveradio" name="radiobutton" value="waves" onchange="setStyle()">
          <br><br>
          Waviness(-100 to 100): <input type="number" step="1" id="settings_wave" onchange="setwave()" min="-1000" max="1000">
          <br><br>
          Slope: <input type="number" step="1" id="settings_slope" onchange="setslope()" min="-1000" max="1000">
          <br><br>
          Distance (-100 to 100): <input type="number" step="1" id="settings_distance" onchange="setdistance()" min="-1000" max="1000">
          <br><br>
          <!--Strata (Theme Colors):<input type="radio" id="themeradio" name="radiobutton1" value="themecol" checked="checked" onchange="setColType()"> -->
          Use custom colors?<input type="checkbox" id="customradio" name="radiobutton1" value="customcol" onchange="setColType()"> <br>
          Base Color: <input id="settings_wfg" type="color" onchange="setwfg()"> <br> Accent Color: <input id="settings_wbg" type="color" onchange="setwbg()">
          <br><br>
        </div>
        
    </div>
    <br>
    <button class="gen" onclick="gen()"> Generate</button>
    <button class="gen" onclick="add()"> Add </button>
    <button class="gen" onclick="insert()"> Insert As Image</button>
    <!--<button class="gen" onclick="save()"> Save </button>-->
    <p id="idAccountOfEffectiveUsr" style="display: none"><?=Session.getEffectiveUser().getEmail()?></p>

    <br>
    <br>
    <p>Preview</p>
    <br>
    <img id="preview">
    <br>
    <canvas id="canvas" style="overflow: hidden;position: relative; border-style: none; display:none;"></canvas>
    <br>
    <!--<br>
    <p>Saves</p>
    <br>-->
</div>

<script type="text/javascript">
  var coll = document.getElementsByClassName("collapsible");
  var i;

  var style = 1; 
  function checkorig(){
    document.getElementById('origradio').checked = true;
    setStyle();
  }
  function checkhex() {
    document.getElementById('hexradio').checked = true;
    setStyle();
  }
  function checkwave(){
    document.getElementById('waveradio').checked = true;
    setStyle();
  }

  function setStyle() {
    document.getElementById('origbox').style.backgroundColor = "#f1f1f1";
    document.getElementById('hexbox').style.backgroundColor = "#f1f1f1";
    document.getElementById('wavebox').style.backgroundColor = "#f1f1f1";

    if(document.getElementById('hexradio').checked == true){
      document.getElementById('hexbox').style.backgroundColor = "#bddcfc";
      style = 1;
    }
    else if(document.getElementById('waveradio').checked == true){
      document.getElementById('wavebox').style.backgroundColor = "#bddcfc";
      style = 3;
    }
    else{
      document.getElementById('origbox').style.backgroundColor = "#bddcfc";
      style = 2;
    }
  }


  for (i = 0; i < coll.length; i++) {
    coll[i].addEventListener("click", function() {
      this.classList.toggle("active");
      var content = this.nextElementSibling;
      if (content.style.maxHeight){
        content.style.maxHeight = null;
      } else {
        content.style.maxHeight = content.scrollHeight + "px";
      }
    });
  }

  var colors = [
  ["#1976D2","#607D8B","#BBDEFB","#2196F3","#536DFE","#BDBDBD"],
  ["#FE9400","#283339","#19272F","#32434A"],
  ["#9cfdd2","#c4fce9","#dce9de","#1463f5","#6ab0fc","#6c73fc","#7094c9"],
  ["#9cfda1","#9cfdd2","#283339","#19272F","#32434A"],
  ["#B3E5FC","#0288D1","#0097A7","#D4E157","#43A047","#81C784","#FFEE58","#FF8F00","#E65100"],
  ["#D4E157","#43A047","#537234","#81C784","#FFEE58"],
  ["#fb4d18","#bd2210","#e38839","#eda02b","#753218","#cf9f42"],
  ["#e88146","#fdc886","#cca3ab","#e9ac8f","#5f6595","#8d90bd","#b09fc1","#fdba00","#e55542"],
  ["#767d85","#b4bab6","#838a90","#445660","#7185a6","#717d8d","#576872"],
  ["#809342","#415019","#446c25","#385b59","#656462","#1c4922","#8392a5"],
  ["#786c65","#d0b49d","#a78e58","#4e4118","#382812","#aa9788","#836b3a","#b9b66d","#8e883c","#584f4b","#21190b","#b8aaa4"],
  ["#30308c","#040405","#1a1b66","#10114f","#090a38","#5c5c99"],
  ["#F58D47","#FDAC40","#DD8002","#CF7803","#F4AC4A","#FFFF00","#FDA42B"],
  ["#CF0E43","#BD0D3E","#A40B35","#8E092E","#760726","#970606","#630D84"],
  ["#F2D8BC","#FDF6D8","#D1BEA2","#B8A797","#BEB5AB","#8D877B","#9A9087","#BBB7AB","#C1C5C5","#989994"],
  ["#97CFFF","#658DC6","#76A8D8","#D8EC7E","#95B453","#C5D762","#D9E4EE","#E0E3E6","#8BBFFE"]
  ];

  var colornames = [
  "Sea Blue",
  "Dark",
  "Mint",
  "Mint Chip",
  "Rainbow",
  "Forest Green",
  "Appalachian Fall",
  "Pastel Sunset",
  "Pacific Fog",
  "Land Before Time",
  "Desert Stone",
  "Purple Night",
  "Desert Noon",
  "Desert Sunset",
  "Misty Morning",
  "Summer Day"
  ];

  var lightdark = [1,0,0,0,0,0,1,1,1,1,1,1,0,1,0,0]; //bimary array to get if text should be light or dark on theme 0 is dark, 1 light

   colorpal = Math.floor(Math.random()*colors.length); //selected colors
   var img;
   var imgfull;


  function settheme(num){
    document.getElementById(1000+colorpal).classList.remove("selected");
    document.getElementById(1000+colorpal).classList.add("selectBlock");
    console.log("themeset");
    document.getElementById(1000+num).classList.add("selected");
    document.getElementById(1000+num).classList.remove("selectBlock");
    drop = document.getElementById('colordropdown');
    drop.innerText = "Select Theme | " + colornames[num];
    drop.click();
    drop.style.backgroundColor = colors[num][0];
    drop.style.color = (lightdark[num] == 1) ? 'white' : 'black';

    colorpal = num;
    window.scrollTo(0,0);
  }


  function displayThemes() {
    for(var i = 0; i<colors.length; i++){

    var ul = document.getElementById(i);

      for(var a = 0; a<colors[i].length; a++){
        var li = document.createElement("li");
        li.appendChild(document.createTextNode("P"));
        li.style.backgroundColor = colors[i][a];
        li.style.color= colors[i][a];
        ul.appendChild(li);

      }
    }
  }
  displayThemes();

  var times = Math.round(Math.random()*4+4);
  var overlay = 0.0;
  var size = 20;
  var noise = 5;

  //for wave
  var slope = 10;
  var distance = -10;
  var waviness = 3;
  var smoothness = 0.3;
  var cuscol = false;
  var wfg = "";
  var wbg = "";

  function changerows(){
    settings = document.getElementById("settings_rows")
    if(settings.value== "")
    {
      times = Math.round(Math.random()*4+4);
      return;
    }
    times = settings.value;
    if(times > 15){
      settings.value = 15;
    }
    if(times<0){
      settings.value = 0;
    }
    times = settings.value;
  }
  function setoverlay(){
    settings = document.getElementById("settings_overlay")
    if(settings.value== "")
    {
      overlay = 0.0;
      return;
    }
    overlay = settings.value;
    if(overlay > 1){
      settings.value = 1.0;
    }
    if(overlay<0){
      settings.value = 0.0;
    }
    overlay = settings.value;
//      console.log('overlay'+settings.value+typeof(settings.value));
  }
  function sethexsize(){
    settings = document.getElementById("settings_hexsize")
    if(settings.value== "")
    {
      size = 20;
      return;
    }
    size = settings.value;
    if(size > 200){
      settings.value = 200;
    }
    if(size<10){
      settings.value = 10;
    }
    size = settings.value;
  }
  function setnoise(){
    settings = document.getElementById("settings_noise")
    if(settings.value== "")
    {
      noise = 5;
      return;
    }
    noise = settings.value;
    if(noise > 30){
      settings.value = 30;
    }
    if(noise<0){
      settings.value = 30;
    }
    noise = settings.value;
  }
//for waves
  function setwave(){
    settings = document.getElementById("settings_wave")
    if(settings.value== "")
    {
      waviness = 3; //mebbe default to 8
      return;
    }
    waviness = settings.value;
    if(waviness > 100){
      settings.value = 100;
    }
    if(waviness<-100){
      settings.value = -100;
    }
    waviness = settings.value;
  }

  function setdistance(){
    settings = document.getElementById("settings_distance")
    if(settings.value== "")
    {
      distance = -10;
      return;
    }
    distance = settings.value;
    if(distance > 1000){
      settings.value = 1000;
    }
    if(distance<-1000){
      settings.value = -1000;
    }
    distance = settings.value;
  }

  function setslope(){
    settings = document.getElementById("settings_slope")
    if(settings.value== "")
    {
      slope = 10;
      return;
    }
    slope = settings.value;
    if(slope > 1000){
      settings.value = 1000;
    }
    if(slope<0){
      settings.value = 0;
    }
    slope = settings.value;
  }
  function setColType()
  {
    if(document.getElementById('customradio').checked)
      cuscol = true;
    else
      cuscol = false;
  }
  function setwfg()
  {
    wfg = document.getElementById("settings_wfg").value;
  }
  function setwbg()
  {
    wbg = document.getElementById("settings_wbg").value;
  }


////////////////////////////////////////////////////////////////
  function hexToRgb(hex) {
    var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    return result ? [parseInt(result[1], 16),parseInt(result[2], 16),parseInt(result[3], 16)] : null;
  }

  function colchange(col){
    if(Math.random() > 0.5)
      ret = col+Math.random()*noise;
    else
      ret = col-Math.random()*noise;
    if(ret > 255)
      ret = 255;
    if(ret < 0)
      ret = 0;
    return ret;
  }
  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
  }
////////////////////////////////////////////////////////////////////////////////////////////////////////////
  var c = document.getElementById("canvas");
    var ctx = c.getContext("2d");
    c.width = 640*2;
    c.height = 360*2;

  function genorig(){
    var c = document.getElementById("canvas");
    var ctx = c.getContext("2d");
    c.width = 640*2;
    c.height = 360*2;
    ctx.save();

    ctx.shadowBlur = 20;
    ctx.shadowColor = "rgba(0,0,0,0.85)";
    //draw rect
    ctx.rotate((10+Math.random()*40)*Math.PI/180);

    ctx.fillStyle = colors[colorpal][Math.floor(Math.random()*colors[colorpal].length)];
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    var preX = 0; // x val of previous rectangle
    for(i = 0; i<times; i++){
      var cw;
      if(Math.random()>0.5){
        cw = (c.width/times)+(Math.random()*(c.width/(times)));
      }
      else{
        cw = (c.width/times)-(Math.random()*(c.width/(times*3)));
      }
      var color = colors[colorpal][Math.floor(Math.random()*colors[colorpal].length)];

      ctx.fillStyle = color//random colors
      ctx.fillRect(preX, -1000, 10000, 10000);
      preX = preX+cw;
    }
    if(Math.random()>0.5){
      ctx.fillStyle = colors[Math.round(Math.random()*colors.length)]; //random color
      ctx.fillRect(c.width-Math.random()*(c.width)-100, -2000, 50000, 2000);
    }
    else{
     ctx.fillStyle = colors[colorpal][0]; //random color
     var yVal = Math.random() < 0.5 ? c.height : 0;
     if(yVal>0){ //bottom circle
        var xVal = Math.random() < 0.5 ? c.width/3 : c.width-c.width/6;
        ctx.moveTo(xVal,yVal);
        ctx.arc(xVal, yVal, Math.random()*100+500, 0, 2 * Math.PI);
        ctx.fill();
      }
      else{
        var xVal = Math.random() < 0.5 ? c.width/4 : c.width-c.width/6;
        ctx.moveTo(xVal,yVal);
        ctx.arc(xVal, yVal, Math.random()*100+400, 0, 2 * Math.PI);
        ctx.fill();
      }

    }
    //gray overlay
    ctx.restore();
    ctx.fillStyle = 'rgba(255,255,255,'+overlay+')';
    ctx.fillRect(0,0,c.width,c.height);

    imgfull = c.toDataURL("image/png");
    document.getElementById("preview").src = imgfull;
    document.getElementById("preview").style.width = "100%";
    img = imgfull.substring(22) ;

  }
////////////////////////////////////////////////////////////////////////////////////////////////////////////
  function genhex(){
    var c = document.getElementById("canvas");
    var ctx = c.getContext("2d");
    c.width = 640*2;
    c.height = 360*2;

    var x = 0;
    var y = 0;
    ctx.fillStyle = "gainsboro";

    ctx.shadowBlur = 3;
    ctx.shadowColor = "rgba(0,0,0,0.85)";
    ctx.save()
    ctx.restore();
    ctx.fillStyle = '#bbbbbb';
    x = 0;
    y = 0;
    var newcolarr = colors[colorpal].slice();
    shuffle(newcolarr);

    for (var i = 0; i < c.width/size; i++) {

      for (var b = 0; b<c.height/size; b++) {
          ctx.beginPath();
          ctx.moveTo(x + size * Math.cos(0), y + size * Math.sin(0));

          for (var side = 0; side < 7; side++) {
            ctx.lineTo(x + size * Math.cos(side * 2 * Math.PI / 6), y + size * Math.sin(side * 2 * Math.PI / 6));
          }
          //color stuff
          colidx = Math.floor((i+b)/(c.width/size/newcolarr.length)) % newcolarr.length
          colcol = newcolarr[colidx];
          nextcol = hexToRgb(newcolarr[(colidx+1)%newcolarr.length]);
          diagcol = hexToRgb(colcol);
          for(var xd = 0; xd < 3; xd++)
          {
            diagcol[xd] = diagcol[xd] + (nextcol[xd]-diagcol[xd])/(c.width/size/newcolarr.length)*((i+b)%(c.width/size/newcolarr.length));
          }
          ctx.fillStyle = 'rgb('+colchange(diagcol[0])+','+colchange(diagcol[1])+','+colchange(diagcol[2])+')';
          ctx.fill();
          y = y+size*1.732050808;
        }
      x= x+size*1.5;
      if(i%2 == 0)
        y = -size*0.866025404;
      else
        y = 0;
    }
    //gray overlay
    ctx.restore();
    ctx.fillStyle = 'rgba(255,255,255,'+overlay+')';
    ctx.fillRect(0,0,c.width,c.height);

    imgfull = c.toDataURL("image/png");
    document.getElementById("preview").src = imgfull;
    document.getElementById("preview").style.width = "100%";
    img = imgfull.substring(22);
  }

  function gradient(a, b) {
      return (b.y-a.y)/(b.x-a.x);
  }

  function bzCurve(points, f, t) {
    console.log("wave");
      if (typeof(f) == 'undefined') f = 0.3; // sharpness of curve
      if (typeof(t) == 'undefined') t = 0.6; //built in variation // waviness

      ctx.beginPath();

      var m = 0;
      var dx1 = 0;
      var dy1 = 0;
      var y = distance; //distance y between each curve
      for (var a = 0; a< 7; a++) {

          let region = new Path2D();
          region.moveTo(0,0);
          region.lineTo(points[0].x, points[0].y - y*a); //line to the bottom left where curve starts
          var preP = points[0];
          preP.y = preP.y - y*a;

          for (var i = 1; i < points.length; i++) {
              var curP = points[i];
              curP.y = curP.y - y*a; //move up y*a
              nexP = points[i + 1];

              if (nexP) {
                  m = gradient(preP, nexP);
                  dx2 = (nexP.x - curP.x) * -f;
                  dy2 = dx2 * m * t;
              } else {
                  dx2 = 0;
                  dy2 = 0;
              }

              region.bezierCurveTo(
                  preP.x - dx1, preP.y - dy1,
                  curP.x + dx2, curP.y + dy2,
                  curP.x, curP.y
              );

              dx1 = dx2;
              dy1 = dy2;
              preP = curP;
          }
          region.lineTo(1280,0); //fill entire canvas vetically
          region.lineTo(0,0);
          rgbcolor = hexToRgb(colorpal[1]);
          fg_col = colors[colorpal][Math.floor(Math.random()*colors[colorpal].length)];
            
          if(cuscol == true)
            fg_col = wfg
          ctx.fillStyle = 'rgba('+hexToRgb(fg_col)+',0.3)';
          ctx.fill(region);
      }
      ctx.stroke();
  }
  
  ////////////////////////////////////////////////////////////////////////////////////////////////

  // Generate random data
  var variation;
  var dy;

  function genwaves(){

    ctx.clearRect(0, 0, canvas.width, canvas.height);
  
    var bg_col = colors[colorpal][Math.floor(Math.random()*colors[colorpal].length)];
    if(cuscol == true)
      bg_col = wbg;
    console.log(bg_col);
    ctx.fillStyle = bg_col;
    ctx.fillRect(0,0,c.width,c.height);
      //ctx.clearRect(0, 0, 600, 400);
      variation = 100;//document.getElementById("variation").value;
      dy = slope;//document.getElementById("dy").value;
      var lines = [];
      var prey = 720;
      var X = -10;
      var t = 400; // control the width of X.
      for (var i = 0; i < 10; i++ ) {
          Y = prey - Math.floor((Math.random() * variation) + dy);
          prey = Y;
          p = { x: X, y: Y };
          lines.push(p);
          X = X + t;
      }

      // Draw smooth line
      ctx.setLineDash([0]);
      ctx.lineWidth = 2;
      ctx.strokeStyle = "blue";
      bzCurve(lines, smoothness, waviness);

    ctx.fillStyle = 'rgba(255,255,255,'+overlay+')';
    ctx.fillRect(0,0,c.width,c.height);

    imgfull = c.toDataURL("image/png");
    document.getElementById("preview").src = imgfull;
    document.getElementById("preview").style.width = "100%";
    img = imgfull.substring(22) ;
  }

  var issue;
  var issuemsg = "Multiple Accounts Issue: This is a well-known bug Google is working to fix. See https://issuetracker.google.com/issues/69270374 for details.\nA workaround for this is to log out of all Google accounts and then log back in to the one Google account you want to use for Slides Background. You can also open an incognito window, log in, and use Slides Backgrounds from there. Thanks for your patience!";

  function issuechecker(gsresponse)
  {
    var usrWhoLoaded = document.getElementById('idAccountOfEffectiveUsr').innerHTML;
//          console.log('issue: '+gsresponse+'-'+usrWhoLoaded);
    if(gsresponse != usrWhoLoaded)
    {
      alert(issuemsg);
      issue = true;
      return;
    }
    else
      issue = false;
      google.script.run.addImageSlide(img);
  }

  function gen()
  {
    if(document.getElementById('hexradio').checked == true)
      genhex();
    else if(document.getElementById('waveradio').checked == true)
      genwaves();
    else
      genorig();
//      while(img == null || img.length < 10)
//      {
//        genimage();
//        console.log("fin genimage()");
//      }
    if(issue == null)
      google.script.run.withSuccessHandler(issuechecker).checkMultipleAccountIssue(); //runs issuechecker, which adds the image if no issue
    else if(issue == true)
    {
      alert(issuemsg);
      return;
    }
    else
      google.script.run.addImageSlide(img);
  }

  function insert(){
    if(img == null)
    {
      alert("Please click Generate first.");
      return;
    }
    if(issue == true)
    {
      alert(issuemsg);
      return;
    }
    google.script.run.addImage(img);
  }

  function add(){
    if(img == null)
    {
      alert("Please click Generate first.");
      return;
    }
    if(issue == true)
    {
      alert(issuemsg);
      return;
    }
    google.script.run.addImageSlide(img);
  }

  function addsave(id){   //save code
    console.log(id);
    var tempimg = document.getElementById(id).src;

    tempimg = tempimg.substring(22);
    google.script.run.addImageSlide(tempimg);

  }

  var savedid  = 100; //id of saved image

  function save(){
    if(img == null)
    {
      alert("Please click Generate first.");
      return;
    }
    if(issue == true)
    {
      alert(issuemsg);
      return;
    }
    var saved = document.createElement("img");
    saved.src = imgfull;
    saved.style.width = "100%";
    saved.id = savedid;
    document.body.appendChild(saved);

    var buttonadd = document.createElement("input");
    buttonadd.type = "button";
    buttonadd.value = "add";
    buttonadd.id = savedid+1000;
    buttonadd.classList.add("gen");
    buttonadd.onclick = function(){
      addsave(this.id - 1000);
    }
    document.body.appendChild(buttonadd);
    var brr = document.createElement("BR");
    document.body.appendChild(brr);
    savedid++;
  }

  //thanks for trying slides background!
</script>
